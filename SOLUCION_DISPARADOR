CREATE TABLE TRABAJADOR(ID INTEGER PRIMARY KEY,NOMBRE VARCHAR(20),SUELDO_BASE FLOAT);
CREATE TABLE RESPALDO(ID INTEGER PRIMARY KEY,NOMBRE VARCHAR2(20),SUELDO_BASE FLOAT);

INSERT INTO TRABAJADOR VALUES(1,'PEPE');
INSERT INTO TRABAJADOR VALUES(2,'LAURA');
INSERT INTO TRABAJADOR VALUES(3,'CARLOS');
INSERT INTO TRABAJADOR VALUES(4,'JUAN');
INSERT INTO TRABAJADOR VALUES(5,'LUIS');

CREATE OR Replace PROCEDURE CONT(NUMERO OUT INTEGER)
AS
BEGIN
SELECT COUNT(*) INTO NUMERO FROM TRABAJADOR;
DBSMS_OUTPUT.PUT_LINE('ENCONTRADOS'||NUMERO);
END;
/

DECLARE 
VALOR INTEGER;
BEGIN
CONTAR(VALOR);
END;
/


CREATE OR REPLACE PROCEDURE COPI
AS
CURSOR CUR_TRABAJADOR IS SELECT * FROM TRABAJADOR;
BEGIN
FOR REC IN CUR_TRABAJADOR LOOP
INSERT INTO TRABAJADOR VALUES(REC.ID, REC.NOMBRE);
END LOOP;
END;
/

CREATE OR REPLACE TRIGGER DISP_TRABAJADOR BEFORE INSERT ON TRABAJADOR FOR EACH ROW
DECLARE
VALOR INTEGER;
BEGIN
CONTAR(VALOR);
IF  VALOR = 3 THEN
COPIAR();
DELETE FROM TRABAJADOR;
END IF;
END;
/


SELECT * FROM TRABAJADOR;
SELECT * FROM RESPALDO_TRABAJADOR;
DELETE  FROM TRABAJADOR;
